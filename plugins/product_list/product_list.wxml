<import src="../../wxParse/wxParse.wxml"/>
<template name="product_list">
<view class="product-list" wx:if="{{products.length}}">
  <view wx:if="{{param.display.search}}" class="product-list-nav">
    <view wx:for="{{searchBar}}" wx:key="{{index}}" class="{{(barIdx == item.type)?'active':''}} nav-item">
      <view class="title" bindtap="{{resortBy}}" data-sortidx="{{index}}">{{item.alias}}</view>
      <view class="operate" wx:if="{{item.type != 'default'}}">
        <text class="{{(item.value == 'desc')?'on':''}} iconfont icon-shangxiajiantou1"></text>
        <text class="{{(item.value == 'asc')?'on':''}} iconfont icon-shangxiajiantou"></text>
      </view>
    </view>
  </view>
  <view class="product-list-content">
    <view bindtap="{{navigateToDetail}}" data-productid="{{item.id}}" wx:for="{{products}}" wx:key="{{item.id}}" class="product-list-item" style="{{styles.li_box}}">
        <image mode="aspectFit" src="{{item.doc_image}}" style="{{styles.thumb}}"></image>
        <view class="product-list-item-detail">
            <view wx:if="{{param.display.title}}" style="{{styles.title}}">{{item.title}}</view>
            <view wx:if="{{param.display.price}}" class="last_price" style="{{styles.price}}">￥{{item.discount_price}}</view>
            <view wx:if="{{param.display.market_price}}" style="{{styles.market_price}}">市场价：￥{{item.price}}</view>
            <view class="desc tooLong" wx:if="{{param.display.desc && item.intro.length && item.intro != 'WxParsePlaceHolder'}}">
            <block wx:for="{{prdintroArr}}" wx:for-index="idx" wx:key="{{idx}}" wx:for-item="intro"><template is="wxParse" data="{{wxParseData: intro}}" wx:if="{{index == idx}}" />
    </block>
            </view>
            <text class="iconfont icon-jiarugouwuche"></text>
            <!--text class="iconfont icon-gouwuche"></text-->
        </view>
    </view>
  </view>
  <view wx:if="{{pagerShow}}" class="list-btn" bindtap="{{loadMore}}">加载更多</view>
</view>
<view wx:else class="product-list">{{errmsg}}</view>
</template>